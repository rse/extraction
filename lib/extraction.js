/*
**  Extraction -- Tree Extraction for JavaScript Object Graphs
**  Copyright (c) 2015 Ralf S. Engelschall <rse@engelschall.com>
**
**  Permission is hereby granted, free of charge, to any person obtaining
**  a copy of this software and associated documentation files (the
**  "Software"), to deal in the Software without restriction, including
**  without limitation the rights to use, copy, modify, merge, publish,
**  distribute, sublicense, and/or sell copies of the Software, and to
**  permit persons to whom the Software is furnished to do so, subject to
**  the following conditions:
**
**  The above copyright notice and this permission notice shall be included
**  in all copies or substantial portions of the Software.
**
**  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
**  EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
**  MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.
**  IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY
**  CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT,
**  TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE
**  SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
*/

(function(f){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=f()}else if(typeof define==="function"&&define.amd){define([],f)}else{var g;if(typeof window!=="undefined"){g=window}else if(typeof global!=="undefined"){g=global}else if(typeof self!=="undefined"){g=self}else{g=this}g.Extraction = f()}})(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(_dereq_,module,exports){
(function (global){
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.ASTY=e()}}(function(){return function e(n,t,r){function i(u,a){if(!t[u]){if(!n[u]){var f="function"==typeof _dereq_&&_dereq_;if(!a&&f)return f(u,!0);if(o)return o(u,!0);var s=new Error("Cannot find module '"+u+"'");throw s.code="MODULE_NOT_FOUND",s}var c=t[u]={exports:{}};n[u][0].call(c.exports,function(e){var t=n[u][1][e];return i(t?t:e)},c,c.exports,e,n,t,r)}return t[u].exports}for(var o="function"==typeof _dereq_&&_dereq_,u=0;u<r.length;u++)i(r[u]);return i}({1:[function(e,n,t){"use strict";function r(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(){i(this,e)}return o(e,[{key:"init",value:function(e,n,t,i){if(arguments.length<2)throw new Error("init: invalid number of arguments");if(this.ctx=e,this.ASTy=!0,this.T=n,this.L={L:0,C:0,O:0},this.A={},this.C=[],this.P=null,"object"===("undefined"==typeof t?"undefined":r(t)))for(var o in t)t.hasOwnProperty(o)&&this.set(o,t[o]);return"object"===("undefined"==typeof i?"undefined":r(i))&&i instanceof Array&&this.add(i),this}},{key:"type",value:function(e){if(0===arguments.length)return this.T;if(1===arguments.length)return this.T=e,this;throw new Error("type: invalid number of arguments")}},{key:"pos",value:function(e,n,t){if(0===arguments.length)return{line:this.L.L,column:this.L.C,offset:this.L.O};if(arguments.length<=3)return this.L.L=e||0,this.L.C=n||0,this.L.O=t||0,this;throw new Error("pos: invalid number of arguments")}},{key:"set",value:function(){for(var e=this,n=arguments.length,t=Array(n),i=0;n>i;i++)t[i]=arguments[i];if(1===t.length&&"object"===r(t[0]))Object.keys(t[0]).forEach(function(n){e.A[n]=t[0][n]});else{if(2!==t.length)throw new Error("set: invalid number of arguments");this.A[t[0]]=t[1]}return this}},{key:"unset",value:function(){var e=this;if(1===arguments.length&&"object"===r(arguments[0])&&arguments[0]instanceof Array)arguments[0].forEach(function(n){delete e.A[n]});else{if(1!==arguments.length)throw new Error("unset: invalid number of arguments");delete this.A[arguments[0]]}return this}},{key:"get",value:function(e){if(1!==arguments.length)throw new Error("get: invalid number of arguments");if("string"!=typeof e)throw new Error("get: invalid key argument");return this.A[e]}},{key:"attrs",value:function(){return Object.keys(this.A)}},{key:"nth",value:function(){if(null===this.P)return 1;var e=this.P.C.indexOf(this);if(0>e)throw new Error("nth: internal error -- node not in childs of its parent");return e}},{key:"ins",value:function(e){for(var n=this,t=arguments.length,i=Array(t>1?t-1:0),o=1;t>o;o++)i[o-1]=arguments[o];if(0===i.length)throw new Error("ins: invalid number of arguments");if(0>e&&(e=this.C.length+1-e),!(e>=0&&e<=this.C.length))throw new Error("ins: invalid position");var u=function(t){if(!n.ctx.isA(t))throw new Error("ins: invalid AST node argument");n.C.splice(e++,0,t),t.P=n};return i.forEach(function(e){"object"===("undefined"==typeof e?"undefined":r(e))&&e instanceof Array?e.forEach(function(e){u(e)}):null!==e&&u(e)}),this}},{key:"add",value:function(){for(var e=this,n=arguments.length,t=Array(n),i=0;n>i;i++)t[i]=arguments[i];if(0===t.length)throw new Error("add: invalid number of arguments");var o=function(n){if(!e.ctx.isA(n))throw new Error("add: invalid AST node argument");e.C.push(n),n.P=e};return t.forEach(function(e){"object"===("undefined"==typeof e?"undefined":r(e))&&e instanceof Array?e.forEach(function(e){o(e)}):null!==e&&o(e)}),this}},{key:"del",value:function(){for(var e=this,n=arguments.length,t=Array(n),r=0;n>r;r++)t[r]=arguments[r];if(0===t.length)throw new Error("del: invalid number of argument");return t.forEach(function(n){if(!e.ctx.isA(n))throw new Error("del: invalid AST node argument");for(var t=!1,r=0;r<e.C.length;r++)if(e.C[r]===n){e.C.splice(r,1),n.P=null,t=!0;break}if(!t)throw new Error("del: AST node not found in childs")}),this}},{key:"childs",value:function(){return this.C}},{key:"parent",value:function(){return this.P}},{key:"serialize",value:function(){return this.ctx.serialize(this.ctx,this)}}]),e}();t["default"]=u},{}],2:[function(e,n,t){"use strict";function r(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(){i(this,e)}return o(e,[{key:"dump",value:function(e){void 0===e&&(e=1/0);var n="";return this.walk(function(t,i){if(!(i>e)){for(var o=0;i>o;o++)n+="    ";n+=t.T+" ";var u=Object.keys(t.A);u.length>0&&!function(){n+="(";var e=!0;u.forEach(function(i){e?e=!1:n+=", ",n+=i+": ";var o=t.A[i];switch("undefined"==typeof o?"undefined":r(o)){case"boolean":case"number":n+=o.toString();break;case"string":var u=function(e){return e.charCodeAt(0).toString(16).toUpperCase()};n+='"'+o.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+u(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+u(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+u(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+u(e)})+'"';break;case"object":n+=o instanceof RegExp?o.source:JSON.stringify(o);break;default:n+=JSON.stringify(o)}}),n+=") "}(),n+="["+t.L.L+"/"+t.L.C+"]\n"}},"downward"),n}}]),e}();t["default"]=u},{}],3:[function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){r(this,e)}return i(e,[{key:"merge",value:function(e){var n=this,t=arguments.length<=1||void 0===arguments[1]?!1:arguments[1],r=arguments.length<=2||void 0===arguments[2]?{}:arguments[2];if(!this.ctx.isA(e))throw new Error("merge: invalid AST node argument");if(t){var i=e.pos();this.pos(i.L,i.C,i.O)}return e.attrs().forEach(function(t){var i="undefined"!=typeof r[t]?r[t]:t;null!==i&&n.set(i,e.get(t))}),e.childs().forEach(function(e){n.add(e)}),this}}]),e}();t["default"]=o},{}],4:[function(e,n,t){"use strict";function r(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function i(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(){i(this,e)}return o(e,null,[{key:"serialize",value:function(e,n){var t=function i(e){var n={T:e.T,L:{L:e.L.L,C:e.L.C,O:e.L.O}},t=Object.keys(e.A);return t.length>0&&(n.A={},t.forEach(function(t){var i=e.A[t];switch("undefined"==typeof i?"undefined":r(i)){case"boolean":case"number":case"string":n.A[t]=i;break;default:n.A[t]=JSON.parse(JSON.stringify(i))}})),e.C.length>0&&(n.C=e.C.map(function(e){return i(e)})),n};if(!e.isA(n))throw new Error("serialize: not an ASTy node");return JSON.stringify({ASTy:t(n)})}},{key:"unserialize",value:function(e,n){var t=function o(n){var t=e.create(n.T);return t.pos(n.L.L,n.L.C,n.L.O),"object"===r(n.A)&&Object.keys(n.A).forEach(function(e){var i=n.A[e];switch("undefined"==typeof i?"undefined":r(i)){case"boolean":case"number":case"string":t.set(e,i);break;default:t.set(e,JSON.parse(JSON.stringify(i)))}}),"object"===r(n.C)&&n.C instanceof Array&&t.add(n.C.map(function(e){return o(e)})),t},i=JSON.parse(n);if("object"!==("undefined"==typeof i?"undefined":r(i))||"object"!==r(i.ASTy))throw new Error("unserialize: not an ASTy JSON export");return t(i.ASTy)}}]),e}();t["default"]=u},{}],5:[function(e,n,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r={major:1,minor:4,micro:1,date:20151229};t["default"]=r},{}],6:[function(e,n,t){"use strict";function r(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(){r(this,e)}return i(e,[{key:"walk",value:function(e){var n=arguments.length<=1||void 0===arguments[1]?"downward":arguments[1],t=function r(t,i,o){("downward"===n||"both"===n)&&e.call(null,t,i,o,"downward"),t.C.forEach(function(e){r(e,i+1,t)}),("upward"===n||"both"===n)&&e.call(null,t,i,o,"upward")};return t(this,0,null),this}}]),e}();t["default"]=o},{}],7:[function(e,n,t){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function o(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var u=function(){function e(e,n){for(var t=0;t<n.length;t++){var r=n[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(n,t,r){return t&&e(n.prototype,t),r&&e(n,r),n}}(),a=e("./asty-base.js"),f=r(a),s=e("./asty-merge.js"),c=r(s),l=e("./asty-walk.js"),d=r(l),h=e("./asty-dump.js"),y=r(h),v=e("./asty-serialize.js"),g=r(v),p=e("./asty-version.js"),m=r(p),b=function(){function e(){var n=this;o(this,e),this.ASTYNode=function(){};var t=[[f["default"],"init","type","pos","set","unset","get","attrs","nth","ins","add","del","childs","parent"],[c["default"],"merge"],[d["default"],"walk"],[y["default"],"dump"]];return t.forEach(function(e){var t=e[0].prototype;e.slice(1).forEach(function(e){n.ASTYNode.prototype[e]=t[e]})}),this}return u(e,[{key:"version",value:function(){return m["default"]}},{key:"extend",value:function(e){for(var n in e)e.hasOwnProperty(n)&&(this.ASTYNode.prototype[n]=e[n]);return this}},{key:"create",value:function(e){return(new this.ASTYNode).init(this,e)}},{key:"isA",value:function(e){return"object"===("undefined"==typeof e?"undefined":i(e))&&e instanceof this.ASTYNode&&"boolean"==typeof e.ASTy&&e.ASTy===!0}},{key:"serialize",value:function(e){return g["default"].serialize(this,e)}},{key:"unserialize",value:function(e){return g["default"].unserialize(this,e)}}]),e}();n.exports=b},{"./asty-base.js":1,"./asty-dump.js":2,"./asty-merge.js":3,"./asty-serialize.js":4,"./asty-version.js":5,"./asty-walk.js":6}]},{},[1,2,3,4,5,6,7])(7)});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],2:[function(_dereq_,module,exports){
(function (global){
!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.CacheLRU=e()}}(function(){return function e(t,n,i){function r(u,s){if(!n[u]){if(!t[u]){var l="function"==typeof _dereq_&&_dereq_;if(!s&&l)return l(u,!0);if(o)return o(u,!0);var a=new Error("Cannot find module '"+u+"'");throw a.code="MODULE_NOT_FOUND",a}var h=n[u]={exports:{}};t[u][0].call(h.exports,function(e){var n=t[u][1][e];return r(n?n:e)},h,h.exports,e,t,n,i)}return n[u].exports}for(var o="function"==typeof _dereq_&&_dereq_,u=0;u<i.length;u++)r(i[u]);return r}({1:[function(e,t,n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(n,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){return i(this,e),this._index={},this._LRU={newer:null},this._MRU={older:null},this._LRU.newer=this._MRU,this._MRU.older=this._LRU,this._cur=0,this._max=1/0,this._dispose=function(){},this}return r(e,[{key:"limit",value:function(e){var t=this._max;return arguments.length>0&&(this._max=e,this._purge()),t}},{key:"dispose",value:function(e){return this._dispose=e,this}},{key:"length",value:function(){return this._cur}},{key:"keys",value:function(){return this.each(function(e,t){this.push(t)},[])}},{key:"values",value:function(){return this.each(function(e){this.push(e)},[])}},{key:"each",value:function(e,t){arguments<2&&(t=this);for(var n=0,i=this._MRU.older;i!==this._LRU;)e.call(t,i.val,i.key,n++),i=i.older;return t}},{key:"has",value:function(e){var t=this._index[e];return void 0!==t}},{key:"peek",value:function(e){var t=this._index[e];return void 0===t?void 0:t.expires<Date.now()?void this.del(t.key):t.val}},{key:"touch",value:function(e){var t=this._index[e];if(void 0===t)throw new Error("touch: no such item");return this._promote(t),this}},{key:"get",value:function(e){var t=this._index[e];return void 0===t?void 0:t.expires<Date.now()?void this.del(t.key):(this._promote(t),t.val)}},{key:"set",value:function(e,t,n){arguments.length<3&&(n=1/0),n+=Date.now();var i=this._index[e];if(void 0===i)i={older:null,newer:null,key:e,val:t,expires:n},this._index[e]=i,this._attach(i),this._cur++,this._purge();else{var r=i.val;i.val=t,this._promote(i),this._dispose.call(void 0,i.key,r,"set")}return this}},{key:"del",value:function(e){var t=this._index[e];if(void 0===t)throw new Error("del: no such item");return delete this._index[e],this._detach(t),this._cur--,this._dispose.call(void 0,e,t.val,"del"),this}},{key:"clear",value:function(){for(;this._cur>0;)this.del(this._LRU.newer.key);return this}},{key:"_purge",value:function(){for(;this._cur>this._max;)this.del(this._LRU.newer.key)}},{key:"_promote",value:function(e){this._detach(e),this._attach(e)}},{key:"_detach",value:function(e){e.older.newer=e.newer,e.newer.older=e.older,e.older=null,e.newer=null}},{key:"_attach",value:function(e){e.older=this._MRU.older,e.newer=this._MRU,e.newer.older=e,e.older.newer=e}}]),e}();n["default"]=o,t.exports=n["default"]},{}]},{},[1])(1)});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],3:[function(_dereq_,module,exports){
(function (global){
!function(e,n,r){"function"==typeof define&&"undefined"!=typeof define.amd?define(n,function(){return r(e)}):"object"==typeof module&&"object"==typeof module.exports?module.exports=r(e):e[n]=r(e)}("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,"PEGUtil",function(){var e={};e.makeAST=function(e,n){return function(){return n.util.__makeAST.call(null,e().start.line,e().start.column,e().start.offset,arguments)}},e.makeUnroll=function(e,n){return function(r,t,o){if("object"!=typeof t||!(t instanceof Array))throw new n.util.__SyntaxError("unroll: invalid list argument for unrolling",typeof t,"Array",e());if("undefined"!=typeof o){"number"==typeof o&&(o=[o]);var a=[];null!==r&&a.push(r);for(var u=0;u<t.length;u++)for(var l=0;l<o.length;l++)a.push(t[u][o[l]]);return a}return null!==r&&t.unshift(r),t}};var n=function(e,n){var r=e.length,t=n-20;0>t&&(t=0);var o=n+20;o>r&&(o=r);var a=function(e){return e.charCodeAt(0).toString(16).toUpperCase()},u=function(e,n,r){return e.substr(n,r).replace(/\\/g,"\\\\").replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+a(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+a(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+a(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+a(e)})};return{prolog:u(e,t,n-t),token:u(e,n,1),epilog:u(e,n+1,o-(n+1))}};return e.parse=function(r,t,o){if("object"!=typeof r)throw new Error("invalid parser object (not an object)");if("function"!=typeof r.parse)throw new Error('invalid parser object (no "parse" function)');if("string"!=typeof t)throw new Error("invalid input text (not a string)");if("undefined"!=typeof o&&"object"!=typeof o)throw new Error("invalid options (not an object)");"undefined"==typeof o&&(o={});var a={ast:null,error:null};try{var u;u="function"==typeof o.makeAST?o.makeAST:function(e,n){return{line:e().start.line,column:e().start.column,offset:e().start.offset,args:n}};var l={util:{makeUnroll:e.makeUnroll,makeAST:e.makeAST,__makeAST:u,__SyntaxError:r.SyntaxError}};"string"==typeof o.startRule&&(l.startRule=o.startRule),a.ast=r.parse(t,l),a.error=null}catch(i){if(a.ast=null,i instanceof r.SyntaxError){var f=function(e,n){return"undefined"!=typeof e?e:n};a.error={line:f(i.location.start.line,0),column:f(i.location.start.column,0),message:i.message,found:f(i.found,""),expected:f(i.expected,""),location:n(t,f(i.location.start.offset,0))}}else a.error={line:0,column:0,message:i.message,found:"",expected:"",location:n("",0)}}return a},e.errorMessage=function(e,n){for(var r=e.location,t="line "+e.line+" (column "+e.column+"): ",o="",a=0;a<t.length+r.prolog.length;a++)o+="-";var u=t+r.prolog+r.token+r.epilog+"\n"+o+"^\n"+e.message+(n?"":"\n");return u},e});
}).call(this,typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {})

},{}],4:[function(_dereq_,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function dsl2ast(e,t){t.debug&&console.log("extraction: DEBUG: extraction tree DSL:\nextraction: DEBUG: | "+e);var r=ASTcache.get(e);if(void 0!==r?t.debug&&console.log("extraction: DEBUG: extraction tree AST: reusing from cache"):!function(){t.debug&&console.log("extraction: DEBUG: extraction tree AST: generating from scratch");var n=new _asty2["default"],o=_pegjsUtil2["default"].parse(PEGparser,e,{makeAST:function(e,t,r,o){return n.create.apply(n,o).pos(e,t,r)}});if(null!==o.error)throw new Error("failed to parse extraction tree DSL:\n"+_pegjsUtil2["default"].errorMessage(o.error,!0).replace(/^/gm,"ERROR: "));r=o.ast,ASTcache.set(e,r)}(),"Object"!==r.type()&&"Array"!==r.type())throw new Error("extraction tree DSL has to be an Object or Array at outmost scope");return t.debug&&console.log("extraction: DEBUG: extraction tree AST:\n"+r.dump().replace(/\r?\n$/,"").replace(/^/gm,"extraction: DEBUG: | ")),r}Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=dsl2ast;var _asty=_dereq_("asty"),_asty2=_interopRequireDefault(_asty),_pegjsUtil=_dereq_("pegjs-util"),_pegjsUtil2=_interopRequireDefault(_pegjsUtil),_cacheLru=_dereq_("cache-lru"),_cacheLru2=_interopRequireDefault(_cacheLru),PEGparser=function(){function e(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}function t(e,r,n,o){this.message=e,this.expected=r,this.found=n,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}function r(e){function r(){return o(Ue,we)}function n(t){var r,n,o=je[t];if(o)return o;for(r=t-1;!je[r];)r--;for(o=je[r],o={line:o.line,column:o.column,seenCR:o.seenCR};t>r;)n=e.charAt(r),"\n"===n?(o.seenCR||o.line++,o.column=1,o.seenCR=!1):"\r"===n||"\u2028"===n||"\u2029"===n?(o.line++,o.column=1,o.seenCR=!0):(o.column++,o.seenCR=!1),r++;return je[t]=o,o}function o(e,t){var r=n(e),o=n(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:o.line,column:o.column}}}function i(e){Fe>we||(we>Fe&&(Fe=we,Te=[]),Te.push(e))}function a(e,r,n,o){function i(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}function a(e,t){function r(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0100-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1000-\uFFFF]/g,function(e){return"\\u"+t(e)})}var n,o,i,a=new Array(e.length);for(i=0;i<e.length;i++)a[i]=e[i].description;return n=e.length>1?a.slice(0,-1).join(", ")+" or "+a[e.length-1]:a[0],o=t?'"'+r(t)+'"':"end of input","Expected "+n+" but "+o+" found."}return null!==r&&i(r),new t(null!==e?e:a(r,n),r,n,o)}function u(){var e;return e=c(),e===m&&(e=l()),e}function c(){var t,r,n,o,a,u,c,l;return t=we,r=A(),r!==m?(123===e.charCodeAt(we)?(n=C,we++):(n=m,0===Ge&&i(E)),n!==m?(o=A(),o!==m?(a=s(),a===m&&(a=null),a!==m?(u=A(),u!==m?(125===e.charCodeAt(we)?(c=R,we++):(c=m,0===Ge&&i(S)),c!==m?(l=A(),l!==m?(Ue=t,r=D(a),t=r):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)):(we=t,t=m),t}function l(){var t,r,n,o,a,u,c,l;return t=we,r=A(),r!==m?(91===e.charCodeAt(we)?(n=w,we++):(n=m,0===Ge&&i(U)),n!==m?(o=A(),o!==m?(a=s(),a===m&&(a=null),a!==m?(u=A(),u!==m?(93===e.charCodeAt(we)?(c=j,we++):(c=m,0===Ge&&i(F)),c!==m?(l=A(),l!==m?(Ue=t,r=T(a),t=r):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)):(we=t,t=m),t}function s(){var t,r,n,o,a,u,c,l;if(t=we,e.substr(we,2)===G?(r=G,we+=2):(r=m,0===Ge&&i(q)),r!==m?(n=A(),n!==m?(o=h(),o!==m?(Ue=t,r=B(o),t=r):(we=t,t=m)):(we=t,t=m)):(we=t,t=m),t===m)if(t=we,r=p(),r!==m){for(n=[],o=we,a=A(),a!==m?(44===e.charCodeAt(we)?(u=L,we++):(u=m,0===Ge&&i(P)),u!==m?(c=A(),c!==m?(l=p(),l!==m?(a=[a,u,c,l],o=a):(we=o,o=m)):(we=o,o=m)):(we=o,o=m)):(we=o,o=m);o!==m;)n.push(o),o=we,a=A(),a!==m?(44===e.charCodeAt(we)?(u=L,we++):(u=m,0===Ge&&i(P)),u!==m?(c=A(),c!==m?(l=p(),l!==m?(a=[a,u,c,l],o=a):(we=o,o=m)):(we=o,o=m)):(we=o,o=m)):(we=o,o=m);n!==m?(Ue=t,r=$(r,n),t=r):(we=t,t=m)}else we=t,t=m;return t}function p(){var t,r,n,o,a,c;return t=we,r=f(),r!==m?(n=A(),n!==m?(58===e.charCodeAt(we)?(o=k,we++):(o=m,0===Ge&&i(z)),o!==m?(a=A(),a!==m?(c=u(),c!==m?(Ue=t,r=Z(r,c),t=r):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)):(we=t,t=m),t===m&&(t=we,33===e.charCodeAt(we)?(r=O,we++):(r=m,0===Ge&&i(M)),r===m&&(r=null),r!==m?(n=A(),n!==m?(o=f(),o!==m?(Ue=t,r=I(r,o),t=r):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)),t}function f(){var t,r,n,o,a,u;return t=we,r=we,n=d(),r=n!==m?e.substring(r,we):n,r!==m&&(Ue=t,r=H(r)),t=r,t===m&&(t=we,42===e.charCodeAt(we)?(r=J,we++):(r=m,0===Ge&&i(K)),r!==m&&(Ue=t,r=N()),t=r,t===m&&(t=we,r=h(),r!==m?(n=A(),n!==m?(e.substr(we,2)===Q?(o=Q,we+=2):(o=m,0===Ge&&i(V)),o!==m?(a=A(),a!==m?(u=h(),u!==m?(Ue=t,r=W(r,u),t=r):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)):(we=t,t=m)):(we=t,t=m),t===m&&(t=we,r=h(),r!==m&&(Ue=t,r=X(r)),t=r))),t}function h(){var t,r,n,o,a,u;if(t=we,r=we,n=we,45===e.charCodeAt(we)?(o=Y,we++):(o=m,0===Ge&&i(ee)),o===m&&(o=null),o!==m){if(a=[],te.test(e.charAt(we))?(u=e.charAt(we),we++):(u=m,0===Ge&&i(re)),u!==m)for(;u!==m;)a.push(u),te.test(e.charAt(we))?(u=e.charAt(we),we++):(u=m,0===Ge&&i(re));else a=m;a!==m?(o=[o,a],n=o):(we=n,n=m)}else we=n,n=m;return r=n!==m?e.substring(r,we):n,r!==m&&(Ue=t,r=ne(r)),t=r,t===m&&(t=we,e.substr(we,3)===oe?(r=oe,we+=3):(r=m,0===Ge&&i(ie)),r!==m&&(Ue=t,r=ae(r)),t=r,t===m&&(t=we,e.substr(we,2)===ue?(r=ue,we+=2):(r=m,0===Ge&&i(ce)),r!==m&&(Ue=t,r=le(r)),t=r)),t}function d(){var t,r,n,o;if(t=we,se.test(e.charAt(we))?(r=e.charAt(we),we++):(r=m,0===Ge&&i(pe)),r!==m){for(n=[],fe.test(e.charAt(we))?(o=e.charAt(we),we++):(o=m,0===Ge&&i(he));o!==m;)n.push(o),fe.test(e.charAt(we))?(o=e.charAt(we),we++):(o=m,0===Ge&&i(he));n!==m?(r=[r,n],t=r):(we=t,t=m)}else we=t,t=m;return t}function A(){var e,t;for(Ge++,e=[],t=g(),t===m&&(t=y());t!==m;)e.push(t),t=g(),t===m&&(t=y());return Ge--,e===m&&(t=m,0===Ge&&i(de)),e}function g(){var t,r,n,o,a,u;if(Ge++,t=we,e.substr(we,2)===ge?(r=ge,we+=2):(r=m,0===Ge&&i(ye)),r!==m){for(n=[],o=we,a=we,Ge++,ve.test(e.charAt(we))?(u=e.charAt(we),we++):(u=m,0===Ge&&i(xe)),Ge--,u===m?a=void 0:(we=a,a=m),a!==m?(e.length>we?(u=e.charAt(we),we++):(u=m,0===Ge&&i(me)),u!==m?(a=[a,u],o=a):(we=o,o=m)):(we=o,o=m);o!==m;)n.push(o),o=we,a=we,Ge++,ve.test(e.charAt(we))?(u=e.charAt(we),we++):(u=m,0===Ge&&i(xe)),Ge--,u===m?a=void 0:(we=a,a=m),a!==m?(e.length>we?(u=e.charAt(we),we++):(u=m,0===Ge&&i(me)),u!==m?(a=[a,u],o=a):(we=o,o=m)):(we=o,o=m);n!==m?(r=[r,n],t=r):(we=t,t=m)}else we=t,t=m;if(t===m)if(t=we,e.substr(we,2)===_e?(r=_e,we+=2):(r=m,0===Ge&&i(be)),r!==m){for(n=[],o=we,a=we,Ge++,e.substr(we,2)===Ce?(u=Ce,we+=2):(u=m,0===Ge&&i(Ee)),Ge--,u===m?a=void 0:(we=a,a=m),a!==m?(e.length>we?(u=e.charAt(we),we++):(u=m,0===Ge&&i(me)),u!==m?(a=[a,u],o=a):(we=o,o=m)):(we=o,o=m);o!==m;)n.push(o),o=we,a=we,Ge++,e.substr(we,2)===Ce?(u=Ce,we+=2):(u=m,0===Ge&&i(Ee)),Ge--,u===m?a=void 0:(we=a,a=m),a!==m?(e.length>we?(u=e.charAt(we),we++):(u=m,0===Ge&&i(me)),u!==m?(a=[a,u],o=a):(we=o,o=m)):(we=o,o=m);n!==m?(e.substr(we,2)===Ce?(o=Ce,we+=2):(o=m,0===Ge&&i(Ee)),o!==m?(r=[r,n,o],t=r):(we=t,t=m)):(we=t,t=m)}else we=t,t=m;return Ge--,t===m&&(r=m,0===Ge&&i(Ae)),t}function y(){var t,r;if(Ge++,t=[],Se.test(e.charAt(we))?(r=e.charAt(we),we++):(r=m,0===Ge&&i(De)),r!==m)for(;r!==m;)t.push(r),Se.test(e.charAt(we))?(r=e.charAt(we),we++):(r=m,0===Ge&&i(De));else t=m;return Ge--,t===m&&(r=m,0===Ge&&i(Re)),t}var v,x=arguments.length>1?arguments[1]:{},m={},_={spec:u},b=u,C="{",E={type:"literal",value:"{",description:'"{"'},R="}",S={type:"literal",value:"}",description:'"}"'},D=function(e){return Be("Object").add(e)},w="[",U={type:"literal",value:"[",description:'"["'},j="]",F={type:"literal",value:"]",description:'"]"'},T=function(e){return Be("Array").add(e)},G="->",q={type:"literal",value:"->",description:'"->"'},B=function(e){return Be("Depth").set({depth:e})},L=",",P={type:"literal",value:",",description:'","'},$=function(e,t){return qe(e,t,3)},k=":",z={type:"literal",value:":",description:'":"'},Z=function(e,t){return e.add(t)},O="!",M={type:"literal",value:"!",description:'"!"'},I=function(e,t){return null!==e&&t.set({not:!0}),t},H=function(e){return Be("Property").set({id:e})},J="*",K={type:"literal",value:"*",description:'"*"'},N=function(){return Be("Property").set({any:!0})},Q="..",V={type:"literal",value:"..",description:'".."'},W=function(e,t){return Be("Property").set({from:e,to:t})},X=function(e){return Be("Property").set({from:e,to:e})},Y="-",ee={type:"literal",value:"-",description:'"-"'},te=/^[0-9]/,re={type:"class",value:"[0-9]",description:"[0-9]"},ne=function(e){return parseInt(e,10)},oe="-oo",ie={type:"literal",value:"-oo",description:'"-oo"'},ae=function(e){return-(1/0)},ue="oo",ce={type:"literal",value:"oo",description:'"oo"'},le=function(e){return 1/0},se=/^[$a-zA-Z_]/,pe={type:"class",value:"[$a-zA-Z_]",description:"[$a-zA-Z_]"},fe=/^[$a-zA-Z0-9_]/,he={type:"class",value:"[$a-zA-Z0-9_]",description:"[$a-zA-Z0-9_]"},de={type:"other",description:"blank"},Ae={type:"other",description:"comment"},ge="//",ye={type:"literal",value:"//",description:'"//"'},ve=/^[\r\n]/,xe={type:"class",value:"[\\r\\n]",description:"[\\r\\n]"},me={type:"any",description:"any character"},_e="/*",be={type:"literal",value:"/*",description:'"/*"'},Ce="*/",Ee={type:"literal",value:"*/",description:'"*/"'},Re={type:"other",description:"whitespaces"},Se=/^[ \t\r\n]/,De={type:"class",value:"[ \\t\\r\\n]",description:"[ \\t\\r\\n]"},we=0,Ue=0,je=[{line:1,column:1,seenCR:!1}],Fe=0,Te=[],Ge=0;if("startRule"in x){if(!(x.startRule in _))throw new Error("Can't start parsing from rule \""+x.startRule+'".');b=_[x.startRule]}var qe=x.util.makeUnroll(r,x),Be=x.util.makeAST(r,x);if(v=b(),v!==m&&we===e.length)return v;throw v!==m&&we<e.length&&i({type:"end",description:"end of input"}),a(null,Te,Fe<e.length?e.charAt(Fe):null,Fe<e.length?o(Fe,Fe+1):o(Fe,Fe))}return e(t,Error),{SyntaxError:t,parse:r}}(),ASTcache=new _cacheLru2["default"];ASTcache.limit(64);
},{"asty":1,"cache-lru":2,"pegjs-util":3}],5:[function(_dereq_,module,exports){
"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{"default":e}}function _typeof(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}var _slicedToArray=function(){function e(e,t){var r=[],o=!0,n=!1,a=void 0;try{for(var i,l=e[Symbol.iterator]();!(o=(i=l.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(u){n=!0,a=u}finally{try{!o&&l["return"]&&l["return"]()}finally{if(n)throw a}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();Object.defineProperty(exports,"__esModule",{value:!0});var _extractionSeen=_dereq_("./extraction-seen.js"),_extractionSeen2=_interopRequireDefault(_extractionSeen),_extractionDsl=_dereq_("./extraction-dsl.js"),_extractionDsl2=_interopRequireDefault(_extractionDsl),extractValue=function(e,t,r,o,n,a,i){return r.procValueBefore&&(e=r.procValueBefore(e,n)),r.debug&&console.log("extraction: DEBUG: match VALUE: path: "+n+", depth: "+o+", "+("mode: "+(void 0!==i?"DEPTH":"MATCH")+", ")+("graph: "+("undefined"==typeof e?"undefined":_typeof(e))+", AST: "+(null!==t?t.type():"null"))),r.procValueAfter&&(e=r.procValueAfter(e,n)),e},extractObjectOrArray=function e(t,r,o,n,a,i,l){o.procValueBefore&&(t=o.procValueBefore(t,a)),o.debug&&console.log("extraction: DEBUG: match OBJECT: path: "+a+", depth: "+n+", "+("mode: "+(void 0!==l?"DEPTH":"MATCH")+", ")+("graph: "+("undefined"==typeof t?"undefined":_typeof(t))+", AST: "+(null!==r?r.type():"null")));var u=i.get(t);if(u)t=o.makeRefValue?o.makeRefValue(u,a,t):u;else{i.set(t,a);var f=void 0;void 0===l&&(f=r.childs(),1===f.length&&"Depth"===f[0].type()&&(l=n+f[0].get("depth"),f=void 0));var c=function(e,t,r){var o=!1,n=null;if(void 0!==t)o=!0;else for(var a=0;a<e.length;a++){var i=!1;if(e[a].get("id")===r)i=!0;else if(e[a].get("any")===!0)i=!0;else{var l=e[a].get("from"),u=e[a].get("to");void 0!==l&&void 0!==u&&l<=Number(r)&&Number(r)<=u&&(i=!0)}i&&(e[a].get("not")===!0?o=!1:(o=!0,n=e[a],1===n.childs().length&&(n=n.childs()[0])))}return[o,n]};if(t instanceof Array){var d=!1;if(null!==r&&"Array"!==r.type()){if(!o.ignoreMatchErrors)throw new Error('extraction failed at "'+a+'": found "Array", expected "'+r.type()+'"');d=!0}var p=[];if(!d&&(void 0===l||void 0!==l&&l>n))for(var y=0,v=0;y<t.length;y++){var s=c(f,l,v),h=_slicedToArray(s,2),x=h[0],g=h[1];x&&("object"===_typeof(t[y])&&null!==t[y]?p[v++]=e(t[y],g,o,n+1,a+"."+y,i,l):p[v++]=extractValue(t[y],g,o,n+1,a+"."+y,i,l))}t=p}else{var d=!1;if(null!==r&&"Object"!==r.type()){if(!o.ignoreMatchErrors)throw new Error('extraction failed at "'+a+'": found "Object", expected "'+r.type()+'"');d=!0}var _={};if(!d&&(void 0===l||void 0!==l&&l>n))for(var b in t)if(Object.hasOwnProperty.call(t,b)){var m=c(f,l,b),A=_slicedToArray(m,2),w=A[0],g=A[1];w&&("object"===_typeof(t[b])&&null!==t[b]?_[b]=e(t[b],g,o,n+1,a+"."+b,i,l):_[b]=extractValue(t[b],g,o,n+1,a+"."+b,i,l))}t=_}}return o.procValueAfter&&(t=o.procValueAfter(t,a)),t},extract=function(e,t,r){if("object"!==("undefined"==typeof e?"undefined":_typeof(e)))throw new Error("invalid graph argument (expected object type)");if(null===e)throw new Error("invalid graph argument (expected not-null value)");if("string"!=typeof t)throw new Error("invalid tree argument (expected string type)");if(void 0===r&&(r={}),"object"!==("undefined"==typeof r?"undefined":_typeof(r)))throw new Error("invalid options argument (expected object type)");var o=(0,_extractionDsl2["default"])(t,r),n=new _extractionSeen2["default"];return extractObjectOrArray(e,o,r,0,"@self",n,void 0)};exports["default"]=extract;
},{"./extraction-dsl.js":4,"./extraction-seen.js":7}],6:[function(_dereq_,module,exports){
"use strict";function _typeof(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}Object.defineProperty(exports,"__esModule",{value:!0});var reifyInternal=function e(t,r,n,o){r.procValueBefore&&(t=r.procValueBefore(t,n)),r.debug&&console.log("reify: DEBUG: path: "+n+", graph: "+("undefined"==typeof t?"undefined":_typeof(t)));var f=!1;if(f=r.isReference?r.isReference(t):"string"==typeof t&&t.match(/^@self(?:\..+|)$/)){var i=void 0;if(i=r.getObject?r.getObject(t,n):o[t],void 0===i)throw new Error('invalid object reference "'+t+'" at path "'+n+'"');t=i}else if(null!==t&&"object"===("undefined"==typeof t?"undefined":_typeof(t)))if(r.setObject?r.setObject(t,n):o[n]=t,t instanceof Array)for(var l=0;l<t.length;l++)t[l]=e(t[l],r,n+"."+l,o);else for(var a in t)Object.hasOwnProperty.call(t,a)&&(t[a]=e(t[a],r,n+"."+a,o));return r.procValueAfter&&(t=r.procValueAfter(t,n)),t},reify=function(e,t){if("object"!==("undefined"==typeof e?"undefined":_typeof(e)))throw new Error("invalid graph argument (expected object type)");if(null===e)throw new Error("invalid graph argument (expected not-null value)");if(void 0===t&&(t={}),"object"!==("undefined"==typeof t?"undefined":_typeof(t)))throw new Error("invalid options argument (expected object type)");return reifyInternal(e,t,"@self",{"@self":e})};exports["default"]=reify;
},{}],7:[function(_dereq_,module,exports){
"use strict";function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var s=n[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(n,t,s){return t&&e(n.prototype,t),s&&e(n,s),n}}();Object.defineProperty(exports,"__esModule",{value:!0});var Seen=function(){return"function"==typeof WeakMap?function(){function e(){_classCallCheck(this,e),this.seenMap=new WeakMap}return _createClass(e,[{key:"set",value:function(e,n){this.seenMap.set(e,n)}},{key:"get",value:function(e){return this.seenMap.get(e)}}]),e}():function(){function e(){_classCallCheck(this,e),this.seenSeq=[],this.seenMap={}}return _createClass(e,[{key:"set",value:function(e,n){this.seenMap[this.seenSeq.length]=n,this.seenSeq.push(e)}},{key:"get",value:function(e){var n=this.seenSeq.indexOf(e);return n>=0?this.seenMap[n]:void 0}}]),e}()}();exports["default"]=Seen;
},{}],8:[function(_dereq_,module,exports){
"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}var _extractionExtract=_dereq_("./extraction-extract.js"),_extractionExtract2=_interopRequireDefault(_extractionExtract),_extractionReify=_dereq_("./extraction-reify.js"),_extractionReify2=_interopRequireDefault(_extractionReify);module.exports={extract:_extractionExtract2["default"],reify:_extractionReify2["default"]};
},{"./extraction-extract.js":5,"./extraction-reify.js":6}]},{},[8])(8)
});


//# sourceMappingURL=bundle.map